<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>SOA·IACORE — Dashboard Operativo</title>

<meta http-equiv="refresh" content="60">

<style>
:root{
  --blue:#0B3D91;
  --blue2:#1F5FD6;
  --bg:#0B1220;
  --card:#111A2E;
  --ink:#E6ECF3;
  --muted:#9FB0C8;
}
*{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto;}
body{margin:0;background:var(--bg);color:var(--ink);}
header{
  padding:24px;
  text-align:center;
  background:linear-gradient(90deg,var(--blue),var(--blue2));
  font-size:22px;
  font-weight:600;
}
.container{
  max-width:1100px;
  margin:auto;
  padding:30px;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:20px;
}
.card{
  background:var(--card);
  border-radius:14px;
  padding:22px;
  box-shadow:0 8px 30px rgba(0,0,0,.4);
}
.card h2{margin:0 0 10px;font-size:18px;color:#7DB4FF;}
.metric{font-size:38px;font-weight:700;color:#ffffff;}
small{color:var(--muted);}
.footer{
  text-align:center;
  font-size:13px;
  padding:20px;
  color:var(--muted);
}
</style>
</head>

<body>

<header>SOA·IACORE — Dashboard Operativo</header>

<div class="container">
  <div class="card">
    <h2>Estado General</h2>
    <div class="metric" id="estado-general">—</div>
    <small>Promedio real de fases</small>
  </div>

  <div class="card">
    <h2>Pipeline Publicación</h2>
    <div class="metric" id="pipeline">—</div>
  </div>

  <div class="card">
    <h2>Automatización</h2>
    <div class="metric" id="automatizacion">—</div>
  </div>

  <div class="card">
    <h2>UI / Dashboard</h2>
    <div class="metric" id="uiux">—</div>
  </div>

  <div class="card">
    <h2>Publicación Final</h2>
    <div class="metric" id="publicacion">—</div>
  </div>
</div>

<div class="footer">
  SOA·IACORE · Actualización automática cada 60s
</div>

<script>
fetch('status.json', {cache:'no-store'})
.then(r=>r.json())
.then(data=>{
  const total = data.fases.reduce((a,f)=>a+f.porcentaje,0);
  document.getElementById('estado-general').textContent =
    Math.round(total / data.fases.length) + '%';

  data.fases.forEach(f=>{
    if(f.nombre.includes('Push')) document.getElementById('pipeline').textContent = f.porcentaje+'%';
    if(f.nombre.includes('Cron')) document.getElementById('automatizacion').textContent = f.porcentaje+'%';
    if(f.nombre.includes('Dashboard')) document.getElementById('uiux').textContent = f.porcentaje+'%';
    if(f.nombre.includes('AutoDeploy')) document.getElementById('publicacion').textContent = f.porcentaje+'%';
  });
})
.catch(()=>console.warn('status.json no disponible'));
</script>

</body>
</html>
