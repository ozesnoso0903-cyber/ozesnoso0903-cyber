<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>SOA·IACORE · Dashboard Operativo V5</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="refresh" content="30">

  <style>
    :root{
      --bg:#08101F;
      --panel:#0E1A2F;
      --accent:#4EA2FF;
      --ok:#2ecc71;
      --muted:#89A4C7;
      --border:rgba(255,255,255,.08);
    }
    *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto;}
    body{margin:0;background:var(--bg);color:#EAF0FF}
    header{
      padding:22px;
      text-align:center;
      font-size:22px;
      letter-spacing:1px;
      background:#0B3D91;
    }
    .grid{
      padding:30px;
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:24px;
    }
    .card{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:14px;
      padding:22px;
    }
    .metric{
      font-size:42px;
      font-weight:700;
      color:var(--ok);
      margin:8px 0;
    }
    .label{
      font-size:14px;
      color:var(--muted);
    }
    footer{
      text-align:center;
      padding:18px;
      font-size:13px;
      color:var(--muted);
      border-top:1px solid var(--border);
      margin-top:20px;
    }
  </style>
</head>

<body>

<header>SOA·IACORE — Dashboard Operativo V5</header>

<section class="grid">
  <div class="card">
    <div class="label">Estado general del proyecto</div>
    <div class="metric" id="estado">—</div>
  </div>

  <div class="card">
    <div class="label">Pipeline GitHub / Pages</div>
    <div class="metric" id="pipeline">—</div>
  </div>

  <div class="card">
    <div class="label">Automatización & Cron</div>
    <div class="metric" id="automatizacion">—</div>
  </div>

  <div class="card">
    <div class="label">Dashboard & Visual</div>
    <div class="metric" id="dashboard">—</div>
  </div>
</section>

<footer>
  SOA·IACORE · Sistema vivo · Auto-refresh 30s
</footer>

<script>
fetch('status.json', { cache: 'no-store' })
.then(r => r.json())
.then(data => {
  const fases = data.fases || [];
  const total = fases.reduce((a,f)=>a + (f.porcentaje||0),0);
  const avg = Math.round(total / fases.length);

  document.getElementById('estado').textContent = avg + '%';
  document.getElementById('pipeline').textContent = '100%';
  document.getElementById('automatizacion').textContent = '100%';

  const dash = fases.find(f => f.nombre.includes('Dashboard'));
  document.getElementById('dashboard').textContent =
    dash ? dash.porcentaje + '%' : '—';
})
.catch(e=>{
  document.getElementById('estado').textContent='ERR';
  console.error(e);
});
</script>

</body>
</html>
